åŸºäºå¯¹GPT4Recè®ºæ–‡çš„æ·±å…¥åˆ†æï¼Œä»¥ä¸‹æ˜¯è¯¥æ¨èç³»ç»Ÿçš„å®æ–½è¿‡ç¨‹æ€»ç»“ï¼š

## ğŸ¯ **æ€»ä½“æ¡†æ¶æ¦‚è§ˆ**

GPT4Recæ˜¯ä¸€ä¸ª ** ç”Ÿæˆå¼æ¨èæ¡†æ¶ **ï¼Œå°†æ¨èä»»åŠ¡è½¬åŒ–ä¸º ** æŸ¥è¯¢ç”Ÿæˆ + æ£€ç´¢ ** ä¸¤ä¸ªæ­¥éª¤ï¼Œçµæ„Ÿæ¥æºäºæœç´¢å¼•æ“çš„å·¥ä½œåŸç†ã€‚

```
ç”¨æˆ·å†å² â†’ ç”ŸæˆæŸ¥è¯¢ â†’ æœç´¢ â†’ æ¨èç»“æœ
```

## ğŸ“‹ **å®æ–½æ­¥éª¤è¯¦è§£**

### **1. æ•°æ®é¢„å¤„ç†**
- ** æ•°æ®é›† **ï¼šAmazon
Reviewæ•°æ®ï¼ˆBeautyå’ŒElectronicsç±»åˆ«ï¼‰
- ** æ¸…æ´— **ï¼šç§»é™¤æ ‡é¢˜ç¼ºå¤±æˆ–è¿‡é•¿ï¼ˆ > 400
å­—ç¬¦ï¼‰çš„ç‰©å“
- ** åºåˆ—æ„å»º **ï¼šæ¯ä¸ªç”¨æˆ·çš„äº¤äº’åºåˆ—å»é‡å¹¶æˆªæ–­ä¸ºæœ€å¤š15é¡¹
- ** åˆ’åˆ† **ï¼šæŒ‰ç”¨æˆ·åˆ’åˆ†è®­ç»ƒ / éªŒè¯ / æµ‹è¯•é›†ï¼ˆ80 % / 10 % / 10 %ï¼‰ï¼Œé‡‡ç”¨next - itemé¢„æµ‹ä»»åŠ¡

### **2. æç¤ºå·¥ç¨‹**
ä½¿ç”¨ç‰¹å®šæç¤ºæ¨¡æ¿æ ¼å¼åŒ–è¾“å…¥ï¼š
```
Previously, the
customer
has
bought:
< ITEM
TITLE
1 >.< ITEM
TITLE
2 > ...
In
the
future, the
customer
wants
to
buy
```

### **3. æ¨¡å‹è®­ç»ƒï¼ˆä¸¤é˜¶æ®µï¼‰**

#### **é˜¶æ®µä¸€ï¼šè¯­è¨€æ¨¡å‹å¾®è°ƒ**
- ** æ¨¡å‹é€‰æ‹© **ï¼šGPT - 2ï¼ˆ117
Må‚æ•°ï¼ŒHuggingFaceå®ç°ï¼‰
- ** è¾“å…¥æ ¼å¼ **ï¼šç”¨æˆ·å†å²å‰T - 1
ä¸ªç‰©å“æ ‡é¢˜ + æç¤º
- ** è®­ç»ƒç›®æ ‡ **ï¼šç”Ÿæˆæœ€åä¸€ä¸ªç‰©å“æ ‡é¢˜ï¼ˆè‡ªå›å½’ç”Ÿæˆï¼‰
- ** è®­ç»ƒé…ç½® **ï¼š
- ä¼˜åŒ–å™¨ï¼šAdam
with weight decay
- å­¦ä¹ ç‡ï¼š0.0001
- Warm - upæ­¥éª¤ï¼š2000
- è®­ç»ƒè½®æ•°ï¼š20

#### **é˜¶æ®µäºŒï¼šæœç´¢å¼•æ“å‚æ•°ä¼˜åŒ–**
- ** æœç´¢ç®—æ³• **ï¼šBM25
- ** å‚æ•°è°ƒä¼˜ **ï¼šç½‘æ ¼æœç´¢
- `k1 âˆˆ {0, 3}
`ï¼ˆæ§åˆ¶è¯é¢‘é¥±å’Œåº¦ï¼‰
- `b âˆˆ (0, 1)
`ï¼ˆæ§åˆ¶æ–‡æ¡£é•¿åº¦å½’ä¸€åŒ–ï¼‰
- ** ä¼˜åŒ–ç›®æ ‡ **ï¼šæ£€ç´¢å‡†ç¡®ç‡ï¼ˆRecall @ Kï¼‰

### **4. å¤šæŸ¥è¯¢ç”Ÿæˆï¼ˆæ ¸å¿ƒæŠ€æœ¯ï¼‰**
- ** ç­–ç•¥ **ï¼šBeam
Searchç”Ÿæˆå¤šä¸ªæŸ¥è¯¢
- ** åŠ¨æœº **ï¼šæ•è·ç”¨æˆ·å¤šç»´åº¦ã€å¤šç²’åº¦å…´è¶£
- ** å®ç° **ï¼š
- ç»™å®šbeam
size
`m`
- åŸºäºç”Ÿæˆåˆ†æ•°
`S(W ^ it, q)`
é€‰æ‹©top - mæŸ¥è¯¢
- é•¿åº¦é€æ­¥æ‰©å±•ï¼Œä¿æŒå¤šæ ·æ€§
- ** ä¼˜åŠ¿ **ï¼šæé«˜æ¨èå¤šæ ·æ€§å’Œè¦†ç›–ç‡

### **5. æ£€ç´¢ä¸æ’åç­–ç•¥**
- ** æ£€ç´¢ **ï¼šæ¯ä¸ªæŸ¥è¯¢ç”¨BM25æ£€ç´¢ç›¸å…³ç‰©å“
- ** æ’ååˆå¹¶ **ï¼š
1.
ä»ç”Ÿæˆåˆ†æ•°æœ€é«˜çš„æŸ¥è¯¢å–top - K / mä¸ªç‰©å“
2.
ä¾æ¬¡ä»å…¶ä»–æŸ¥è¯¢æŒ‰åˆ†æ•°å–éé‡å¤ç‰©å“
3.
ç›´åˆ°å‡‘é½Kä¸ªæ¨è
- ** å¹³è¡¡ **ï¼šç›¸å…³æ€§ä¸å¤šæ ·æ€§

### **6. è¯„ä¼°æŒ‡æ ‡**
- ** ä¸»æŒ‡æ ‡ **ï¼šRecall @ Kï¼ˆæ˜¯å¦åŒ…å«ç›®æ ‡ç‰©å“ï¼‰
- ** å¤šæ ·æ€§ **ï¼šDiversity @ Kï¼ˆåŸºäºJaccardç›¸ä¼¼åº¦ï¼‰
- ** è¦†ç›–ç‡ **ï¼šCoverage @ Kï¼ˆè¦†ç›–ç”¨æˆ·å†å²ç±»åˆ« / å“ç‰Œæ¯”ä¾‹ï¼‰

## âš™ï¸ **å…³é”®æŠ€æœ¯è¦ç‚¹**

### **æ ¸å¿ƒåˆ›æ–°**
1. ** ç”Ÿæˆå¼æ–¹æ³• **ï¼šå°†æ¨èè§†ä¸ºåºåˆ—ç”Ÿæˆé—®é¢˜
2. ** è¯­è¨€ç©ºé—´å­¦ä¹  **ï¼šç”¨æˆ·å’Œç‰©å“éƒ½åœ¨è¯­ä¹‰ç©ºé—´è¡¨ç¤º
3. ** å¤šæŸ¥è¯¢ç”Ÿæˆ **ï¼šBeam
Searchäº§ç”Ÿå¤šæ ·åŒ–å…´è¶£è¡¨ç¤º
4. ** è§£è€¦æ¶æ„ **ï¼šè¯­è¨€æ¨¡å‹å’Œæœç´¢å¼•æ“ç‹¬ç«‹ä¼˜åŒ–

### **å®è·µä¼˜åŠ¿**
- ** å¯è§£é‡Šæ€§ **ï¼šç”Ÿæˆçš„æŸ¥è¯¢ç›´æ¥è§£é‡Šç”¨æˆ·å…´è¶£
- ** å†·å¯åŠ¨å‹å¥½ **ï¼šå¯é€šè¿‡æŸ¥è¯¢æ£€ç´¢æ–°ç‰©å“
- ** çµæ´»æ€§ **ï¼šå¯æ›¿æ¢åº•å±‚æ¨¡å‹ï¼ˆLLM / æœç´¢å¼•æ“ï¼‰
- ** è¯­ä¹‰åˆ©ç”¨ **ï¼šå……åˆ†åˆ©ç”¨ç‰©å“æ ‡é¢˜çš„è¯­ä¹‰ä¿¡æ¯

## ğŸ”„ **å®æ–½æµç¨‹æ€»ç»“**

```mermaid
graph
TD
A[ç”¨æˆ·å†å²åºåˆ—] --> B[æç¤ºæ¨¡æ¿æ ¼å¼åŒ–]
B --> C[GPT - 2
å¾®è°ƒ]
C --> D[å¤šæŸ¥è¯¢Beam
Search]
D --> E[BM25æ£€ç´¢]
E --> F[ç»“æœåˆå¹¶æ’å]
F --> G[Top - Kæ¨è]

H[è®­ç»ƒæ•°æ®] --> C
I[ç‰©å“åº“] --> E
```

## ğŸ“Š **æ€§èƒ½å…³é”®å‘ç°**

1. ** æœ€ä½³é…ç½® **ï¼šç”ŸæˆKä¸ªæŸ¥è¯¢ï¼Œæ¯ä¸ªæŸ¥è¯¢æ£€ç´¢1ä¸ªç‰©å“ï¼ˆK = Kï¼‰
2. ** æ€§èƒ½æå‡ **ï¼š
- Beautyæ•°æ®é›†ï¼šRecall @ 40
æå‡75
.7 %
- Electronicsæ•°æ®é›†ï¼šRecall @ 40
æå‡22
.2 %
3. ** å¤šæ ·æ€§æå‡ **ï¼šå¤šæŸ¥è¯¢æ˜¾è‘—æé«˜Diversity @ Kå’ŒCoverage @ K

## ğŸ› ï¸ **ä»£ç å®ç°è¦ç‚¹**

```python


# ä¼ªä»£ç ç»“æ„
class GPT4Rec:
    def __init__(self):
        self.lm = GPT2()  # è¯­è¨€æ¨¡å‹
        self.se = BM25()  # æœç´¢å¼•æ“

    def train(self, user_sequences):
        # é˜¶æ®µ1ï¼šå¾®è°ƒè¯­è¨€æ¨¡å‹
        self.lm.finetune(sequences)

        # é˜¶æ®µ2ï¼šä¼˜åŒ–æœç´¢å‚æ•°
        self.se.grid_search(queries, items)

    def recommend(self, user_history, k=10):
        # ç”Ÿæˆå¤šä¸ªæŸ¥è¯¢
        queries = self.lm.beam_search(user_history)

        # æ£€ç´¢ç‰©å“
        candidates = []
        for query in queries:
            items = self.se.search(query, top_n=k // len(queries))
            candidates.extend(items)

        # å»é‡å’Œæ’å
        return self.rank_and_deduplicate(candidates, k)


```

## ğŸ’¡ **æ‰©å±•æ€è€ƒ**

1. ** æ¨¡å‹å‡çº§ **ï¼šå¯æ›¿æ¢GPT - 2
ä¸ºæ›´æ–°çš„LLMï¼ˆGPT - 3 / 4ã€Llamaç­‰ï¼‰
2. ** æ£€ç´¢ä¼˜åŒ– **ï¼šBM25å¯å‡çº§ä¸ºç¥ç»ç½‘ç»œæ£€ç´¢å™¨ï¼ˆå¦‚DPRï¼‰
3. ** å·¥ä¸šéƒ¨ç½² **ï¼šéœ€è€ƒè™‘å®æ—¶æ€§ã€ç´¢å¼•æ•ˆç‡ã€æ¨¡å‹æ›´æ–°æœºåˆ¶

è¿™ä¸ªæ¡†æ¶çš„åˆ›æ–°åœ¨äºå°† ** ç”Ÿæˆå¼è¯­è¨€å»ºæ¨¡ ** ä¸ ** ä¿¡æ¯æ£€ç´¢ ** å·§å¦™ç»“åˆï¼Œä¸ºæ¨èç³»ç»Ÿæä¾›äº†æ–°çš„è§†è§’å’Œå¼ºå¤§çš„å¯è§£é‡Šæ€§ã€‚